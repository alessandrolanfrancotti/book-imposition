<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>⛓️ Lil Imposer ⛓️</title>

  <script src="https://cdn.jsdelivr.net/npm/pdf-lib/dist/pdf-lib.min.js"></script>
  <link href="https://fonts.googleapis.com/css2?family=UnifrakturCook:wght@700&display=swap" rel="stylesheet">

  <style>
    :root {
      --chrome-gradient: linear-gradient(to bottom, #fff 0%, #888 48%, #fff 52%, #444 100%);
      --chrome-border: linear-gradient(145deg, #fff, #444, #fff, #888);
    }

    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; overflow: hidden; }

    body {
      font-family: 'Impact', sans-serif;
      background: radial-gradient(circle, #222 0%, #000 100%);
      color: #fff;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 10px;
    }

    .panel {
      background: #000;
      padding: clamp(20px, 4vh, 45px);
      width: 100%;
      max-width: 700px;
      max-height: 98vh;
      display: flex;
      flex-direction: column;
      justify-content: space-between;
      position: relative;
      border: 4px solid;
      border-image: var(--chrome-border) 1;
      box-shadow: 0 0 15px #fff, 0 0 30px rgba(255,255,255,0.5), inset 0 0 10px #fff;
    }

    /* ---------- LOGO ---------- */
    .logo-wrap {
      height: clamp(90px, 18vh, 200px);
      width: 100%;
      margin: 0 0 15px 0;
      overflow: hidden;
    }
    .logo {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* ---------- SECTIONS ---------- */
    .section {
      background: rgba(255, 255, 255, 0.02);
      padding: clamp(10px, 2vh, 20px);
      margin-bottom: clamp(10px, 2vh, 20px);
      border: 2px solid;
      border-image: var(--chrome-border) 1;
    }

    .section-title {
      font-family: 'UnifrakturCook', cursive;
      font-size: clamp(1.2rem, 3vh, 2rem);
      background: var(--chrome-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 10px;
      display: block;
    }

    label {
      font-size: 0.8rem;
      font-weight: bold;
      background: var(--chrome-gradient);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 5px;
      display:block;
    }

    input, select {
      width: 100%;
      padding: 10px;
      background: #000;
      color: #fff;
      font-family: Impact, sans-serif;
      border: 2px solid;
      border-image: var(--chrome-border) 1;
    }

    /* ---------- SIZES ROW ---------- */
    .sizes-row {
      display: flex;
      gap: 12px;
    }
    .col-50 { flex: 2; }
    .col-25 { flex: 1; }

    /* ---------- TERMINAL ---------- */
    #monitor {
      margin-top: 10px;
      font-family: "Courier New", monospace;
      background: #000;
      padding: 10px;
      border: 1px solid #333;
      font-size: 0.8rem;
    }
    .monitor-ok { color: #00ff00; }
    .monitor-error { color: #ff4757; }

    /* ---------- UPLOAD ---------- */
    .upload-zone, .btn-img {
      background: none;
      border: none;
      width: 100%;
      cursor: pointer;
    }
    .upload-wrap, .btn-wrap {
      height: 120px;
      overflow: hidden;
    }
    .upload-wrap img, .btn-wrap img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    /* ---------- CREDITS ---------- */
    .credits {
      position: fixed;
      bottom: 12px;
      left: 14px;
      font-family: Helvetica, Arial, sans-serif;
      font-weight: bold;
      font-size: 0.75rem;
      color: #888;
      z-index: 999;
    }

    .credits a {
      font-family: Impact, sans-serif;
      color: #fff;
      text-decoration: none;
    }
    .credits a:hover {
      text-decoration: underline;
    }

    .hidden { display:none }
  </style>
</head>

<body>

<div class="panel">

  <div class="logo-wrap">
    <img class="logo" src="LILIMPOSER.png">
  </div>

  <div class="section">
    <span class="section-title">Paper</span>

    <div class="sizes-row">
      <div class="col-50">
        <label>SIZES</label>
        <select id="sheetSelect">
          <option value="210,297">A4 (Vertical)</option>
          <option value="297,210">A4 (Horizontal)</option>
          <option value="420,297">A3 (Horizontal)</option>
          <option value="297,420">A3 (Vertical)</option>
          <option value="450,320">SRA3 (Horizontal)</option>
          <option value="320,450">SRA3 (Vertical)</option>
          <option value="custom">CUSTOM</option>
        </select>
      </div>
      <div class="col-25" id="customWCol">
        <label>W mm</label>
        <input type="number" id="customW">
      </div>
      <div class="col-25" id="customHCol">
        <label>H mm</label>
        <input type="number" id="customH">
      </div>
    </div>

    <div id="monitor">> Load a PDF...</div>
  </div>

  <div class="section">
    <span class="section-title">Signatures</span>
    <input type="text" id="sigInput">
  </div>

  <div class="upload-zone" id="uploadZone">
    <input type="file" id="pdfFile" hidden>
    <div class="upload-wrap">
      <img src="DROPTHEBOOK.png">
    </div>
  </div>

  <button id="runBtn" class="btn-img">
    <div class="btn-wrap">
      <img src="DOWNLOAD.png">
    </div>
  </button>

</div>

<!-- CREDITS -->
<div class="credits">
  ©2026, Designed by 
  <a href="https://www.instagram.com/alessandro_lanfrancotti/" target="_blank">
    Alessandro Lanfrancotti
  </a>
</div>

<script>
  const pt = mm => mm * 72 / 25.4;
  const ptToMm = p => p * 25.4 / 72;
  const INNER_CROP_PT = 0.3 * 72;

  let loadedPdf = null;

  const sheetSelect = document.getElementById("sheetSelect");
  const customW = document.getElementById("customW");
  const customH = document.getElementById("customH");
  const customWCol = document.getElementById("customWCol");
  const customHCol = document.getElementById("customHCol");
  const monitor = document.getElementById("monitor");

  function getSheetMm(){
    if(sheetSelect.value === "custom"){
      return [parseFloat(customW.value)||0, parseFloat(customH.value)||0];
    }
    return sheetSelect.value.split(",").map(Number);
  }

  function checkFit(){
    if(!loadedPdf) return;
    const [sW,sH] = getSheetMm();
    const p = loadedPdf.getPages()[0];
    const pW = ptToMm(p.getWidth()) - 7.62;
    const pH = ptToMm(p.getHeight());
    if(sW >= pW*2 && sH >= pH){
      monitor.textContent = "> STATUS OK";
      monitor.className="monitor-ok";
    } else {
      monitor.textContent = "> SHEET TOO SMALL";
      monitor.className="monitor-error";
    }
  }

  document.getElementById("uploadZone").onclick=()=>pdfFile.click();

  pdfFile.onchange = async e=>{
    const buf = await e.target.files[0].arrayBuffer();
    loadedPdf = await PDFLib.PDFDocument.load(buf);
    checkFit();
    let t = loadedPdf.getPageCount();
    sigInput.value = Math.ceil(t/16)*16;
  };

  runBtn.onclick = async ()=>{
    const {PDFDocument} = PDFLib;
    const out = await PDFDocument.create();
    const [sW,sH] = getSheetMm();
    const sheetW = pt(sW), sheetH = pt(sH);

    const src = loadedPdf.getPages();
    const leftBoxes = src.map(p=>({left:0,bottom:0,right:p.getWidth()-INNER_CROP_PT,top:p.getHeight()}));
    const rightBoxes = src.map(p=>({left:INNER_CROP_PT,bottom:0,right:p.getWidth(),top:p.getHeight()}));
    const leftEmb = await out.embedPages(src,leftBoxes);
    const rightEmb = await out.embedPages(src,rightBoxes);

    for(let i=0;i<src.length;i+=2){
      const page = out.addPage([sheetW,sheetH]);
      page.drawPage(leftEmb[i],{x:sheetW/2-leftEmb[i].width,y:(sheetH-leftEmb[i].height)/2});
      page.drawPage(rightEmb[i+1],{x:sheetW/2,y:(sheetH-rightEmb[i+1].height)/2});
    }

    const blob = new Blob([await out.save()],{type:"application/pdf"});
    window.open(URL.createObjectURL(blob));
  };

  sheetSelect.onchange=checkFit;
  customW.oninput=checkFit;
  customH.oninput=checkFit;
</script>

</body>
</html>
